#!/bin/sh

# Extract CMake macros during configure
PREFIX="@CMAKE_INSTALL_PREFIX@"
FLAVOR="@FLAVOR@"
VERSION="@MCCODE_VERSION@"
MC="@MCCODE_PREFIX@"

# Include installation path before any attempt to postconfig
export PATH=${PREFIX}/bin:${PATH}
MCCODE=${FLAVOR}-${VERSION}

# Setup mccode-select and mccode-select-bundle
mccode-select-${MCCODE} --bootstrap

# Setup mcstas/mcxtrace including available tools
mccode-select-bundle --install \
	  ${FLAVOR} \
	  ${VERSION}

# Check if mcdoc is installed and if it needs to run
if [ -x ${PREFIX}/bin/${MC}doc-${VERSION} ] && \
    [ -d ${PREFIX}/lib/${MCCODE}/examples ]; then
    ${PREFIX}/bin/${MC}doc-${VERSION} --text &>/dev/null
fi
