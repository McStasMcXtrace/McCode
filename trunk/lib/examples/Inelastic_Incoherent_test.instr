/*******************************************************************************
*         McStas instrument definition URL=http://www.mcstas.org
*
* Instrument: Inelastic_Incoherent_test 
*
* %Identification
* Written by: Kim Lefmann
* Date: 18.08.06
* Origin: Risoe
* Release: McStas 1.9
* Version: 0.1
* %INSTRUMENT_SITE: tests
*
* Testing the QENS_incoherent component
*
* %Description
* Instrument longer description (type, elements, usage...)
*
* Example: mcrun test.instr <parameters=values>
*
* %Parameters
* Gamma: [meV] QENS width
* fracQE: [1] QENS fraction 
*
* %End
*******************************************************************************/

DEFINE INSTRUMENT Inelastic_Incoherent_test(h_omega=0.5, frac_inel=0.2, Gamma=0.1, fracQE=0.2)

DECLARE
%{
%}

INITIALIZE
%{
%}

TRACE

COMPONENT Origin = Arm()
  AT (0,0,0) ABSOLUTE

COMPONENT source = Source_Maxwell_3(
    height = 0.1, width = 0.1, l_low = 4.04, l_high = 4.05,
    dist = 10, xw = 0.02, yh = 0.02, T1 = 30, T2 = 300, T3 = 300,
    I1 = 1e12, I2 = 0, I3 = 0)
  AT (0, 0, 0) RELATIVE Origin

COMPONENT Emon1 = E_monitor(
    nchan = 1000, filename = "Emon1.dat", xwidth = 0.03,
    yheight = 0.03, Emin = 0, Emax = 10)
  AT (0, 0, 9.989) RELATIVE Origin

COMPONENT Sample = Inelastic_Incoherent(
    radius_i = 0, radius_o = 0.01, h = 0.02, pack = 1, frac = 1,
    f_inel = frac_inel, homega=h_omega, f_QE = fracQE, gamma=Gamma,
    focus_xw = 0.03, focus_yh = 0.10, sig_a = 0, sig_i = 1,
    V0 = 20, target_index = 2)
  AT (0, 0, 10) RELATIVE Origin

COMPONENT detector_arm = Arm()
  AT (0,0,0) RELATIVE Sample
  ROTATED (0,90,0) RELATIVE Sample

COMPONENT Emon2 = E_monitor(
    nchan = 1000, filename = "Emon2.dat", xwidth = 0.03,
    yheight = 0.12, Emin = 4, Emax = 6)
  AT (0, 0, 2) RELATIVE detector_arm

FINALLY
%{
%}

END



