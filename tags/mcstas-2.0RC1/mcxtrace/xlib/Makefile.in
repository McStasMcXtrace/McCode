# Makefile for @MCCODE_NAME@.
#
#   This file is part of the @MCCODE_NAME@ ray-trace simulation package
#   Copyright (C) 1997-2008, All rights reserved
#   Risoe National Laborartory, Roskilde, Denmark
#   Institut Laue Langevin, Grenoble, France
#
#   This program is free software; you can redistribute it and/or modify
#   it under the terms of the GNU General Public License as published by
#   the Free Software Foundation; version 2 of the License.
#
#   This program is distributed in the hope that it will be useful,
#   but WITHOUT ANY WARRANTY; without even the implied warranty of
#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#   GNU General Public License for more details.
#
#   You should have received a copy of the GNU General Public License
#   along with this program; if not, write to the Free Software
#   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA

# Available methods for installation
# make                 normal build
# make install         normal installation
# make install-pgplot  build and install PGPLOT
# make clean           clean distro
# make test            distro self-test
# make plotter         best plotter choice
# make reconfigure     reconfigure @MCCODE_TARNAME@ installation (after software update)


SHELL = /bin/sh

prefix = @prefix@
exec_prefix = @exec_prefix@
bindir = @bindir@
srcdir = @srcdir@
topdir = ..
rootdir = ../../
libdir = @libdir@
mandir = @mandir@
PWD = `pwd`


DEBUG = -DDEBUG=0
libdir_mccode = $(libdir)/@MCCODE_TARNAME@-@MCCODE_VERSION@

CC = @CC@
MINGW = @MINGW@
CFLAGS = @CFLAGS@
LDFLAGS= @LDFLAGS@

USE_NEXUS = @HAVE_NEXUS@

DEFS = @DEFS@ $(DEBUG)
LIBS = @LIBS@

PERL = @PERL@

FLEX = @FLEX@
FLEXFLAGS=-i

BISON = @BISON@
BISONFLAGS = -v -d

INSTALL=@INSTALL@
INSTALL_PROGRAM = @INSTALL_PROGRAM@
INSTALL_DATA = @INSTALL_DATA@

#
# End of configuration section.
#

all:


install: install_@MCCODE_TARNAME@
	$(INSTALL_DATA) $(topdir)/doc/man/*.1 $(mandir)/man1
	@echo "================================================================"
	@echo "Installation of @MCCODE_STRING@ finished."
	@echo "  library  in MCSTAS=$(libdir_mccode)"
	@echo "  binaries in        $(bindir)"
	@echo "Thanks for using @MCCODE_NAME@"
	@echo "================================================================"

# TODO: currently, all Perl scripts use MCSTAS env. Should be changed in the future.
install_mcstas: installdirs $(BINOBJS_mcstas)
	@echo "Install mcstas library..."
	cp -r share/* "${libdir_mccode}/share"

# documentation with mxdoc is broken, as it uses MCSTAS location and env
install_mcxtrace: installdirs $(BINOBJS_mcxtrace)
	@echo "Install mcxtrace library..."
	cp -r share/* "${libdir_mccode}/share"

installdirs:
	$(rootdir)/mkinstalldirs $(libdir) $(libdir_mccode)
